dependencies {
  swaggerUI 'org.webjars:swagger-ui:4.1.3'
}

openapi3 {
  server = "https://api.suwiki.kr"
  title = 'SUWIKI API'
  description = 'SUWIKI API 문서입니다.'
  version = "${applicationVersion}"
  outputFileNamePrefix = "suwiki-api-spec"
}

var swaggerSource = toDir("api-spec/${openapi3.outputFileNamePrefix}.${openapi3.format}").asFile
var duplicateInto = toDir("resources/main/static/docs")

swaggerSources {
  suwiki {
    setInputFile(swaggerSource)
  }
}

tasks.withType(project.GenerateSwaggerUI).configureEach {
  dependsOn ':openapi3'
}

tasks.register("duplicateSwaggerUiIntoJar", Copy) {
  group 'documentation'
  description 'duplicate Swagger UI which generated by task into jar'
  dependsOn ':generateSwaggerUISuwiki'
  from "${generateSwaggerUISuwiki.outputDir}"
  into duplicateInto

  tasks.resolveMainClassName.mustRunAfter ':duplicateSwaggerUiIntoJar'
}

//bootJar {
//  dependsOn ':duplicateSwaggerUiIntoJar'
//}

def toDir(String path) {
  return layout.buildDirectory.dir(path).get()
}
